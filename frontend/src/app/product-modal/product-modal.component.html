<ion-header>
  <ion-toolbar>
    <ion-title>{{ mode === 'edit' ? 'Editar producto' : 'Nuevo producto' }}</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="cancel()">Cerrar</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <form (ngSubmit)="submit()" #formRef="ngForm" class="product-form">
    <ion-list>
      <ion-item>
        <ion-label position="floating">Nombre</ion-label>
        <ion-input required [(ngModel)]="product.name" name="name"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Descripci√≥n</ion-label>
        <ion-textarea
          required
          [(ngModel)]="product.description"
          name="description"
        ></ion-textarea>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Tipo</ion-label>
        <ion-select
          interface="popover"
          [(ngModel)]="product.tipo"
          name="tipo"
          required
        >
          <ion-select-option *ngFor="let tipo of tipos" [value]="tipo.value">
            {{ tipo.label }}
          </ion-select-option>
        </ion-select>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Precio</ion-label>
        <ion-input
          type="number"
          required
          [(ngModel)]="product.price"
          name="price"
        ></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Stock</ion-label>
        <ion-input
          type="number"
          required
          [(ngModel)]="product.stock"
          name="stock"
        ></ion-input>
      </ion-item>
      <ion-item>
        <ion-label position="floating">Imagen (URL opcional)</ion-label>
        <ion-input [(ngModel)]="product.image" name="image"></ion-input>
      </ion-item>
      <ion-item>
        <ion-label>Producto en oferta</ion-label>
        <ion-toggle [(ngModel)]="product.oferta" name="oferta"></ion-toggle>
      </ion-item>
      <ion-item>
        <ion-label>O subir archivo</ion-label>
        <input
          type="file"
          accept="image/*"
          capture="environment"
          (change)="onFileSelected($event)"
        />
      </ion-item>
      <ion-item *ngIf="previewUrl">
        <img
          [src]="previewUrl"
          alt="preview"
          style="max-width: 100%; height: auto"
        />
      </ion-item>
    </ion-list>

    <div
      style="
        display: flex;
        justify-content: flex-end;
        gap: 0.5rem;
        padding: 1rem;
      "
    >
      <ion-button color="medium" type="button" (click)="cancel()"
        >Cancelar</ion-button
      >
      <ion-button type="submit" [disabled]="!formRef.form.valid"
        >{{ mode === 'edit' ? 'Guardar cambios' : 'Crear' }}</ion-button
      >
    </div>
  </form>
</ion-content>
